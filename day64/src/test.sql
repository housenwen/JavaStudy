CREATE TABLE record(
                       id int PRIMARY KEY,
                       date date NULL DEFAULT NULL,
                       price int(11) NULL DEFAULT NULL,
                       type varchar(30)
);

INSERT INTO `record` VALUES (321512352, '2018-01-01', 2119, '家用');
INSERT INTO `record` VALUES (321512353, '2018-01-02', 2619, '生鲜');
INSERT INTO `record` VALUES (321512354, '2018-01-03', 3528, '生鲜');
INSERT INTO `record` VALUES (321512355, '2018-01-04', 2690, '家用');
INSERT INTO `record` VALUES (321512356, '2018-01-05', 2496, '生鲜');
INSERT INTO `record` VALUES (321512357, '2018-01-06', 111, '零食');
INSERT INTO `record` VALUES (321512358, '2018-01-07', 3890, '生鲜');
INSERT INTO `record` VALUES (321512359, '2018-01-08', 3196, '零食');
INSERT INTO `record` VALUES (321512360, '2018-01-09', 1525, '生鲜');
INSERT INTO `record` VALUES (321512361, '2018-01-10', 176, '生鲜');
INSERT INTO `record` VALUES (321512362, '2018-01-11', 2950, '生鲜');
INSERT INTO `record` VALUES (321512363, '2018-01-12', 4365, '生鲜');
INSERT INTO `record` VALUES (321512364, '2018-01-13', 285, '零食');
INSERT INTO `record` VALUES (321512365, '2018-01-14', 2333, '生鲜');
INSERT INTO `record` VALUES (321512366, '2018-01-15', 917, '生鲜');
INSERT INTO `record` VALUES (321512367, '2018-01-16', 3999, '零食');
INSERT INTO `record` VALUES (321512368, '2018-01-17', 4788, '生鲜');
INSERT INTO `record` VALUES (321512369, '2018-01-18', 2429, '零食');
INSERT INTO `record` VALUES (321512370, '2018-01-19', 2810, '零食');
INSERT INTO `record` VALUES (321512371, '2018-01-20', 4520, '生鲜');
INSERT INTO `record` VALUES (321512428, '2019-01-08', 4047, '生鲜');
INSERT INTO `record` VALUES (321512429, '2019-01-09', 383, '家用');
INSERT INTO `record` VALUES (321512430, '2019-01-10', 2998, '零食');
INSERT INTO `record` VALUES (321512431, '2019-01-11', 3448, '零食');
INSERT INTO `record` VALUES (321512432, '2019-01-12', 982, '零食');
INSERT INTO `record` VALUES (321512433, '2019-01-13', 2398, '零食');
INSERT INTO `record` VALUES (321512434, '2019-01-14', 3359, '家用');
INSERT INTO `record` VALUES (321512435, '2019-01-15', 1822, '家用');
INSERT INTO `record` VALUES (321512436, '2019-01-16', 1051, '生鲜');
INSERT INTO `record` VALUES (321512437, '2019-01-17', 3828, '零食');
INSERT INTO `record` VALUES (321512438, '2019-01-18', 2615, '零食');
INSERT INTO `record` VALUES (321512439, '2019-01-19', 2333, '生鲜');
INSERT INTO `record` VALUES (321512440, '2019-01-20', 4410, '生鲜');
INSERT INTO `record` VALUES (321512441, '2019-01-21', 1050, '家用');
INSERT INTO `record` VALUES (321512442, '2019-01-22', 310, '零食');
INSERT INTO `record` VALUES (321512443, '2019-01-23', 4341, '零食');
INSERT INTO `record` VALUES (321512521, '2020-01-21', 3687, '零食');
INSERT INTO `record` VALUES (321512522, '2020-01-22', 672, '家用');
INSERT INTO `record` VALUES (321512523, '2020-01-23', 660, '生鲜');
INSERT INTO `record` VALUES (321512524, '2020-01-24', 3801, '零食');
INSERT INTO `record` VALUES (321512525, '2020-01-25', 2026, '生鲜');
INSERT INTO `record` VALUES (321512526, '2020-01-26', 4855, '生鲜');
INSERT INTO `record` VALUES (321512527, '2020-01-27', 1275, '生鲜');
INSERT INTO `record` VALUES (321512528, '2020-01-28', 794, '生鲜');
INSERT INTO `record` VALUES (321512529, '2020-01-29', 99, '生鲜');
INSERT INTO `record` VALUES (321512530, '2020-01-30', 1806, '零食');
INSERT INTO `record` VALUES (321512531, '2020-01-31', 4118, '零食');
INSERT INTO `record` VALUES (321512532, '2020-02-01', 1932, '生鲜');
INSERT INTO `record` VALUES (321512533, '2020-02-02', 136, '生鲜');
INSERT INTO `record` VALUES (321512534, '2020-02-03', 3896, '生鲜');
INSERT INTO `record` VALUES (321512535, '2020-02-04', 631, '家用');
INSERT INTO `record` VALUES (321512536, '2020-02-05', 4836, '生鲜');
INSERT INTO `record` VALUES (321512537, '2020-02-06', 3718, '家用');
INSERT INTO `record` VALUES (321512538, '2020-02-07', 2999, '家用');
INSERT INTO `record` VALUES (321512539, '2020-02-08', 4991, '生鲜');
INSERT INTO `record` VALUES (321512540, '2020-02-09', 1713, '零食');
INSERT INTO `record` VALUES (321512541, '2020-02-10', 354, '家用');
INSERT INTO `record` VALUES (321512542, '2020-02-11', 3895, '家用');
INSERT INTO `record` VALUES (321512543, '2020-02-12', 362, '家用');
INSERT INTO `record` VALUES (321512544, '2020-02-13', 3316, '家用');

#todo 业务需求1：统计每年订单总金额；
select *
from record group by year(date);

SELECT YEAR(DATE),SUM(price)
FROM record GROUP BY YEAR(DATE);

#todo 业务需求2：统计2020年每个商品分类下，订单的数量和总金额；

select *
from record where year(date) = 2020 group by type;

SELECT TYPE,COUNT(*),SUM(price)
FROM record WHERE YEAR(DATE) = 2020 GROUP BY TYPE;


